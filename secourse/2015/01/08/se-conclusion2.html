<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>微信项目总结</title>
    <meta name="description" content="商业Blog的广告看着太烦了，不过还没搞清楚Jekyll的高级用法。先把技术博客发了再慢慢研究>_<~（过了两周还是这样，果然还是太懒了。。。）
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://yourdomain.com/secourse/2015/01/08/se-conclusion2.html">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Zhiheng's Blog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">微信项目总结</h1>
    <p class="post-meta">Jan 8, 2015</p>
  </header>

  <article class="post-content">
    <p>转眼间一学期过去了，回头看学期开始雄心勃勃要维护的Blog只发了几篇日志，估计这篇也是收尾之作了。每次写新的日志前基本都要重头学一遍jekyll和markdown，也是非常惭愧。迭代二主要的功能基本在展示的时候就都完成了。但是由于要赶其他的Deadline，最后的交付一直拖到了最后一天。</p>

<p>首先总结一下迭代二的情况。迭代二我的重心从后端php代码转移到了前段选座功能的HTML/javascript代码实现上。迭代一虽然做出了一个初步的选座系统，但是存在两个问题。第一是没有管理端后台发布的接口，也就是座位图是写死的；第二是用HTML标签实现的座位图没有实现拖拽、缩放等功能。</p>

<p>从第二个问题先入手，座位图需要支持拖拽、缩放，还要支持点击等事件，经过查阅资料，发现HTML中的SVG图形可以完美支持以上的要求。由于SVG图形本身是一种XML格式，支持DOM操作，因此事件监听不成问题。而且SVG是一种矢量图形，理论上可以无限缩放，只需对viewbox进行合适的设置即可实现拖拽和缩放功能。而第一个问题也就迎刃而解，在管理端设置好座位图信息后，只需将SVG的文本保存，就可以在微信客户端直接显示。与HTML标签实现座位图相比，SVG图形有着更大的自由度，可以支持任意座位排布的扩展。</p>

<p>理论上的问题都已经得到了解决，但是实际的实现又是另一回事。SVG的DOM和普通HTML的DOM操作方法不同，因此很多操作不能用jQuery实现，只能用原生的SVG DOM。而且虽然viewbox可以解决所有的拖拽、缩放操作，但是鼠标事件和具体的viewbox计算还是需要自己实现。在前期尝试的过程中，最开始我试用了各种第三方库，比如鼠标手势的hammer.js、SVG的Raphael.js等。但是经过一周的尝试，决定还是自己重头实现比较好。（不过前期的尝试也不是没有用处，在另一门课的大作业中就用Raphael.js快速画出了优美的图像）。自己实现的过程也是非常痛苦，不仅要考虑功能的实现，还要考虑扩展性。最后实现的效果还算不错，但是扩展性不能说好，只能留给以后的人再去修改了。</p>

<p>微信客户端的选座在迭代二展示之前就完成了，但是由于之后要完成其他的大作业，管理端的发布座位图直到这周才完整实现。在客户端功能的基础上，又加入了拖拽批量选取功能、右键点击设置座位属性功能，已经可以算是一个可用的产品了。</p>

<p>在迭代二的开发中，由于我一直在和SVG的各种奇怪特性作斗争，再加上有一些个人原因，一个月以来写代码的状态一直很差，效率很低。因此后台发布活动等其他工作基本都交给了其他队友完成。其中志斌基本包办了逻辑层的代码，从迭代一最开始学习PHP，完成特定的函数功能，到迭代二独立设计接口模块，十分辛苦。总的来说，由于架构变得庞大，逻辑变得复杂，迭代二的开发项目质量较迭代一稍差，逻辑也稍混乱一些，但是仍然可以令人满意。</p>

<p>本来昨天已经将全部代码测试完成，助教也进行了检查，以为今天只需花一点时间整理一下代码就可以交工了。但是重构的难度远远超出了我的想象。从下午2点开始整理目录结构，修改文件之间的关联，一直到晚上9点才将全部工作做完。晚上7点写文档中的部署部分时，发现项目中的数据库信息和微信公众平台信息都是写死的，也就是很难进行移植。于是又新建了一个XML格式的配置文件，保存各种配置信息。在本地测试没有问题，但是在服务器上就出现了各种奇怪的问题，最后挣扎了一个小时只能宣告放弃。但是今天这个惨痛的失败也令我受益匪浅。软件的部署、特别是Web应用的部署是一个非常关键的问题。之前一直没意识到这一点，做出的项目只能在配置好的环境中运行，很难进行移植。服务器的各种配置应该在功能开发前就设计好，也便于调试，现在直到要交付才想起配置问题，系统已经非常庞大，出了问题难以调试，失败也是必然的结果。</p>

<p>之后是对整个微信项目和软工课的总结。整个微信项目，由于我们是从零开始，因此耗费了更多的时间与精力，光是最后留下的有效代码就有几千行。好处是没有之前代码的束缚，可以自由发挥，而且可以锻炼架构设计的能力；坏处是所有的工作都从零开始，太多的东西需要自己去摸索，也绕了很多弯路。开发过程中的最大收获不是写了多少代码，掌握了多少种语言，学会了多少种库的用法，而是了解了一个真实软件项目的开发过程，了解了开发过程中的人员与项目的管理，了解了之前从未接触过的软件部署，这才是最重要的。现在回顾整个过程，从最开始我连夜赶工实现微信的基本响应，只有简单的5个php文件，一百多行代码；到最后交付的上百个html、css、js、php文件，几千行代码，这中间既有功能实现的喜悦，也有连夜赶工的心酸，还有发现BUG的无奈。这一切都融入了整个项目中。</p>

<p>最后要感谢我的队友，迭代二开发过程中我由于个人原因多少有些消极怠工，但是队友们都没有怨言，很好地完成了工作；迭代二展示前一天晚上由于发现很多BUG，我发了很大的脾气，队友们也没有争论，顺着我的意思修改代码。十分感谢队友们的包容与理解。还要感谢三位助教，耐心帮助我们解决问题，细致检查我们的代码，给我们提出了很多有效的建议。最后要感谢刘强老师，不断给予我们鼓励与支持，将我们真正领上了软件开发之路。</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Zhiheng's Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Zhiheng's Blog</li>
          <li><a href="mailto:zhiheng3@live.cn">zhiheng3@live.cn</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/zhiheng3">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">zhiheng3</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">商业Blog的广告看着太烦了，不过还没搞清楚Jekyll的高级用法。先把技术博客发了再慢慢研究>_<~（过了两周还是这样，果然还是太懒了。。。）
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
